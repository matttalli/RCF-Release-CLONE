(window.rcfRunTime_24113=window.rcfRunTime_24113||[]).push([["interactions/marked/rcfCrossword"],{335:function(t,r,e){"use strict";e.d(r,"a",(function(){return i}));e(25);var n=e(339);function o(t,r,e){return(r=function(t){var r=function(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,r||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof r?r:r+""}(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}class i{constructor(t,r){o(this,"$activity",void 0),o(this,"$selector",void 0),o(this,"interactionFunctions",void 0),this.$activity=t,this.interactionFunctions=r}clearMarkedAnswers(){Object(n.a)(this.$selector)}getUserAnswers(t){return Object(n.b)(this,this.interactionFunctions.getUserAnswer,t)}isComplete(t){return Object(n.c)(this,this.interactionFunctions.isComplete,t)}showAnswers(t,r,e){Object(n.d)(this,t,r,this.interactionFunctions.showAnswer,e)}showMarkedAnswers(t,r){Object(n.e)(this,t,this.interactionFunctions.showMarkedAnswer,r)}showUserAnswers(t){Object(n.f)(this,this.interactionFunctions.showAnswer,t)}reset(){this.interactionFunctions.reset(this.$selector)}}},337:function(t,r,e){"use strict";e.d(r,"a",(function(){return s}));e(6),e(13);var n=e(5),o=e.n(n),i=e(4);function s(t,r){return Object(i.y)(r)?o()([]):t.filter((t,e)=>{let n=o()(e).closest(".itemBasedQuestion");return Object(i.v)(n)===r})}},382:function(t,r,e){"use strict";e(101);const n=[8,9,16,17,18,19,20,27,33,34,35,36,37,38,40,45,46,91,92,93,144,145,219,249];r.a=t=>!n.includes(t)},709:function(t,r,e){"use strict";e.r(r);var n={};e.r(n),e.d(n,"showAnswer",(function(){return o.a})),e.d(n,"getUserAnswer",(function(){return i.a})),e.d(n,"showMarkedAnswer",(function(){return s.a})),e.d(n,"isComplete",(function(){return a.a})),e.d(n,"reset",(function(){return c.a}));e(25);var o=e(440),i=e(443),s=e(470),a=e(444),c=e(472),l=e(5),d=e.n(l),u=e(4),h=e(623);e(6),e(11);var f=t=>t.find("*[data-rcfinteraction='crossword']"),w=e(17);function v(t,r,e){return(r=function(t){var r=function(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,r||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof r?r:r+""}(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}class p{constructor(t){v(this,"character",void 0),v(this,"across",void 0),v(this,"down",void 0),this.character=t}}function g(t,r,e){return(r=function(t){var r=function(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,r||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof r?r:r+""}(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}class m{constructor(t,r){g(this,"startOfWord",void 0),g(this,"index",void 0),g(this,"wordId",void 0),g(this,"isExample",void 0),g(this,"wordElement",void 0),this.startOfWord=t,this.index=r.index,this.wordId=r.id,this.isExample=r.isExample,this.wordElement=r}}e(48);function b(t,r,e){return(r=function(t){var r=function(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,r||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof r?r:r+""}(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}class y{constructor(t,r,e,n,o){b(this,"word",void 0),b(this,"id",void 0),b(this,"index",void 0),b(this,"isExample",void 0),b(this,"isExampleFirstLetter",void 0),this.word=t.toUpperCase(),this.id=r,this.index=e,this.isExample=n,this.isExampleFirstLetter=o}}e(153);var j=t=>t.sort((t,r)=>r.word.length===t.word.length?r.word>t.word?-1:r.word<t.word?1:0:r.word.length-t.word.length);var O=t=>{const r=t.map((t,r)=>new y(t.word,t.id,r,t.isExample,"y"===t.isExample||"y"===t.firstLetterExample));return j(r)},x=e(47);function A(t){var r,e={};this.getSquareGrid=function(t){for(var r=null,e=0,n=null,o=0,i=0;i<t&&(null===(n=this.getGrid(1))||((o=1*Math.min(n.length,n[0].length)/Math.max(n.length,n[0].length))>e&&(r=n,e=o),1!==e));i++);return r},this.getGrid=function(t){for(var e=[],o=!1,s=0,h=0,w=0,v=null,p=0;p<t;p++){if(d(),s=c(),h=Math.floor(u.length/2),w=Math.floor(u[0].length/2),v=f[0],"across"==s?w-=Math.floor(v.word.length/2):h-=Math.floor(v.word.length/2),!1===a(v.word,h,w,s))return r=[v],null;i(v,h,w,s),e.push(f.slice(1));for(var g=0;g<e.length;g++){o=!1;for(var m=0;m<e[g].length;m++){var b=e[g][m],y=l(b.word);if(y){var j=y.row,O=y.col,x=y.direction;i(b,j,O,x),o=!0}else e.length-1==g&&e.push([]),e[g+1].push(b)}if(!o)break}if(o)return n()}return r=e[e.length-1],null},this.getBadWords=function(){return r},this.getLegend=function(r){for(var e={across:[],down:[]},n=!1,o=1,i=0;i<r.length;i++)for(var s=0;s<r[i].length;s++){var a=r[i][s];for(var c in n=!1,e)if(a&&a[c]&&a[c].startOfWord){var l=a[c].index;e[c].push({position:o,index:l,clue:t[l].clue,word:t[l].word,isExample:t[l].isExample,wordId:t[l].id}),n=!0}n&&o++}return e},this.getHTML=function(t){this.deviceMode=RCF.Application.getDeviceMode();const r=this.deviceMode!==x.a.desktop;if(null==t)return window.console&&console.log("No grid supplied to 'getHTML'"),"<table class='crossword'><tr><td>No grid supplied</td></tr></table>";var e=[],n=1,o="",i=!1,s=null,a="",c="";e.push("<table class='crossword'>");for(var l=0;l<t.length;l++){e.push("<tr data-row='".concat(l+1,"'>"));for(var d=0;d<t[l].length;d++){i=!1,o=(s=t[l][d])?"word":"no-border",i=!!s&&(s.across&&s.across.startOfWord||s.down&&s.down.startOfWord),c=(c=!!s&&(s.across&&"y"==s.across.isExample||s.down&&"y"==s.down.isExample))||i&&(s.across&&s.across.startOfWord&&s.across.wordElement.isExampleFirstLetter||s.down&&s.down.startOfWord&&s.down.wordElement.isExampleFirstLetter);var u="r"+(l+1)+"c"+(d+1);if(e.push("<td data-cellid='"+u+"' data-col='"+(d+1)+"' class='"+o+(c?" example ":"")+("word"==o?" dev-markable-container ":"")+"' >"),"word"==o){a="",a=s.across&&s.down?"none":s.across?"across":"down",i&&e.push("<span class='relSpan'><span class='clueNumber'>"+n+"</span></span>"),e.push("<input class='cwWord "+(c?" example ":"")+(i?"wordStart word"+n:"")+"' type='text' data-direction='"+a+"' maxlength=1");var h="",f="";s&&s.across&&(h+="|"+s.across.index+"|",f+="|"+s.across.wordId+"|"),s&&s.down&&(h+="|"+s.down.index+"|",f+="|"+s.down.wordId+"|"),c&&e.push(" READONLY value='"+s.character+"' "),e.push(" data-letter='"+s.character+"' "),e.push(" data-wordindex='"+h+"' data-wordid='"+f+"' "+(r?" READONLY ":"")+">")}else e.push("&nbsp;");i&&n++}e.push("</td>")}return e.push("</table>"),e.join("\n")};var n=function(){var t=49,r=0,e=49,n=0,o=0,i=0,s=0,a=0;for(s=0;s<50;s++)for(a=0;a<50;a++)null!=u[s][a]&&(s<t&&(t=s),s>r&&(r=s),a<e&&(e=a),a>n&&(n=a));var c=r-t+1,l=n-e+1,d=new Array(c);for(s=0;s<c;s++)for(a=0;a<l;a++)d[s]=new Array(l);for(s=t,o=0;o<c;s++,o++)for(a=e,i=0;i<l;a++,i++)d[o][i]=u[s][a];return d},o=function(t,r,n,o,i){var s=t.word.charAt(r);null==u[n][o]&&(u[n][o]=new p(s),e[s]||(e[s]=[]),e[s].push({row:n,col:o}));var a=0===r;u[n][o][i]=new m(a,t)},i=function(t,r,e,n){var i=0,s=0,a=0;if("across"==n)for(i=e,s=0;i<e+t.word.length;i++,s++)o(t,s,r,i,n);else{if("down"!=n)throw"Invalid Direction";for(a=r,s=0;a<r+t.word.length;a++,s++)o(t,s,a,e,n)}},s=function(t,r,e){return null==u[r][e]?0:u[r][e].character==t&&1},a=function(t,r,e,n){var o=0,i=0,a=!1,c=!1,l=!1,d=0;if(r<0||r>=u.length||e<0||e>=u[r].length)return!1;if("across"==n){if(e+t.length>u[r].length)return!1;if(e-1>=0&&null!=u[r][e-1])return!1;if(e+t.length<u[r].length&&null!=u[r][e+t.length])return!1;for(o=r-1,i=e,h=0;o>=0&&i<e+t.length;i++,h++)if(c=null==u[o][i],l=null!=u[r][i]&&u[r][i].character==t.charAt(h),!(c||l))return!1;for(o=r+1,i=e,h=0;o<u.length&&i<e+t.length;i++,h++)if(c=null==u[o][i],l=null!=u[r][i]&&u[r][i].character==t.charAt(h),!(c||l))return!1;for(d=0,i=e,h=0;i<e+t.length;i++,h++){if(!1===(a=s(t.charAt(h),r,i)))return!1;d+=a}}else{if("down"!=n)throw"Invalid Direction";if(r+t.length>u.length)return!1;if(r-1>=0&&null!=u[r-1][e])return!1;if(r+t.length<u.length&&null!=u[r+t.length][e])return!1;for(i=e-1,o=r,h=0;i>=0&&o<r+t.length;o++,h++)if(c=null==u[o][i],l=null!=u[o][e]&&u[o][e].character==t.charAt(h),!(c||l))return!1;for(i=e+1,o=r,h=0;o<r+t.length&&i<u[o].length;o++,h++)if(c=null==u[o][i],l=null!=u[o][e]&&u[o][e].character==t.charAt(h),!(c||l))return!1;for(d=0,o=r,h=0;o<r+t.length;o++,h++){if(!1===(a=s(t.charAt(h,1),o,e)))return!1;d+=a}}return d},c=function(){return Math.floor(2*Math.random())?"across":"down"},l=function(t){for(var r=[],n=0;n<t.length;n++){var o=e[t.charAt(n)];if(o)for(var i=0;i<o.length;i++){var s=o[i],c=s.row,l=s.col,d=a(t,c,l-n,"across"),u=a(t,c-n,l,"down");!1!==d&&r.push({intersections:d,row:c,col:l-n,direction:"across"}),!1!==u&&r.push({intersections:u,row:c-n,col:l,direction:"down"})}}if(!(r.length<1))return r[Math.floor(Math.random()*r.length)]},d=function(){for(var t=0;t<u.length;t++)for(var r=0;r<u[t].length;r++)u[t][r]=null;e={}};if(t.length<2)throw"A crossword must have at least 2 words";var u=new Array(50),h=0;for(h=0;h<50;h++)u[h]=new Array(50);const f=O(t);this.words=f}var E=e(563),M=e(565),C=e(566);e(15),e(16);var L=e(60),P=e(445);var N=e(612);var S=t=>{const r=Object(E.a)(t);if(!r)throw"No words available in Crossword";Object(M.a)(t,r),Object(C.a)(t);const e=new A(r),n=e.getSquareGrid(100);n?(!function(t,r,e){t.find(".rcfCrossword").html(r.getHTML(e))}(t,e,n),function(t,r,e){const n=t.find(".hiddenClues"),o=Object(P.a)(t);n.hide();let i=[];const s=r.getLegend(e);Object.keys(s).forEach(t=>{const r=t,e="across"===t?"interactions.crossword.across":"interactions.crossword.down",o=Object(u.b)(L.a.t(e));i.push("\n\t\t\t<div class='".concat(r,"'>\n\t\t\t\t<h3>").concat(o,"</h3>\n\t\t\t\t<ul>\n\t\t")),s[t].forEach(t=>{const r=n.find("li[data-wordid='".concat(t.wordId,"']"));r.find(".crosswordClueNumbering").text(t.position),r.find(".crosswordClueNumberPunctuation").text("."),i.push(r[0].outerHTML)}),i.push("\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t")}),n.remove(),o.prepend(i.join("\n"))}(t,e,n),function(t){const r=Object(w.a)(t,"data-hiddenword")||"";r.length<1||r.toUpperCase().split("").forEach(r=>{let e=t.find("input.cwWord[data-letter='".concat(r,"']:not(.hiddenLetter,.example)"));if(e.length<1&&(e=t.find("input.cwWord[data-letter='".concat(r,"']:not(.hiddenLetter)")),e.length<1))return;const n=Math.floor(Math.random()*e.length);e.eq(n).addClass("hiddenLetter")})}(t),Object(N.a)(t)):function(t,r){const e="\n\t\t<div class='rcfCrossword invalid'>\n\t\t\t<h3>Cannot build a crossword with these words</h3>\n\t\t\t<ul>\n\t\t\t\t".concat(r.getBadWords().map(t=>"<li>id: ".concat(t.id,", ").concat(t.word,"</li>")).join("\n"),"\n\t\t\t</ul>\n\t\t\t<h4>No intersections could be built</h4>\n\t\t</div>\n\t"),n=t.find(".rcfCrossword"),o=Object(u.O)(e);n.html(o)}(t,e)};var F=e(446),W=e(335);function k(t,r,e){return(r=function(t){var r=function(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,r||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==typeof r?r:r+""}(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}e.d(r,"default",(function(){return T}));class T extends W.a{constructor(t){super(t,n),k(this,"$activity",void 0),k(this,"$selector",void 0),function(t,r){if(Object(u.y)(r))throw"Empty Activity passed to Crossword interaction constructor";const e="".concat(r[0].id).concat(Object(w.a)(r,"data-seed")||"");Math.seedrandom(e),t.$activity=r,t.$selector=f(r),t.$selector.each((t,r)=>{const e=d()(r);S(e)}),Object(h.a)(r,"crossword")}(this,t)}showMarkedAnswers(t){super.showMarkedAnswers(t),Object(F.a)(this.$selector)}}}}]);
/* build created on 15/08/2025 16:19 */
//# sourceMappingURL=http://localhost:4000/source-maps/interactions/marked/rcfCrossword.js.map