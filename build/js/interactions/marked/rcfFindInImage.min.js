(window.rcfRunTime_24113=window.rcfRunTime_24113||[]).push([["interactions/marked/rcfFindInImage"],{687:function(e,t,r){"use strict";r.r(t);r(25),r(31),r(6),r(86);var a=r(451),n=r(5),s=r.n(n);r(11);var c=e=>e.find(".dev-prompts .prompt.active"),o=(r(48),r(336));r(13);var i=e=>e.find("svg .clickableElement");var l=e=>i(e).filter(".selected");var v=e=>{const t=c(e),r=l(e).map((e,t)=>t.id).get();Object(o.c)(t,r)},m=(r(153),r(99));var d=(e,t)=>{const r=t[0].id;return(m.a(e,"data-answers")||"").split(",").sort().indexOf(r)>-1};var u=(e,t)=>{const r=l(e),a=m.a(t,"data-answers").split(",").sort(),n=r.map((e,t)=>t.id).get().sort();return n.length!==a.length||n.join("")!==a.join("")};var b=(e,t)=>{let r=!0;return l(e).each((e,a)=>{const n=s()(a),c=d(t,n),o=c?"correctAnswer":"incorrectAnswer";c||(r=!1),n.addClass(o)}),r},f=r(4),g=r(453),p=r(17);var O=e=>"random"===(Object(p.a)(e,"data-mode")||"");var w=e=>e.find(".dev-prompts .prompt");var j=e=>{const t=w(e).length;let r;return r=O(e)?Number(Object(p.a)(e,"data-numberofquestionstoplay")||t):t,r};var h=e=>e.map((e,t)=>{const r=s()(t);return Object(f.v)(r)}).get();let y=[];const C=e=>{if(y.length>0){const t=y.shift(),r=e.find(".dev-prompts .prompt[data-rcfid='".concat(t,"']")),a=r.find(".inlinePlayerContainer");if(c(e).removeClass("active"),!Object(f.y)(a)){const e=Object(f.i)(a);Object(g.a)(e,a)}return r.addClass("active"),r}return s()([])};var A=function(e,t){const r=Object(f.i)(e);return new Promise(e=>{r.trigger("rcf.play.coreAudio",{audio:t,onComplete:()=>{e()}})})};var $=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;await Object(f.E)(t),e.removeClass("correctAnswer"),e.removeClass("incorrectAnswer"),e.removeClass("givingFeedback")};var I=e=>{const t=i(e);t.removeClass("selected"),t.removeClass("correctAnswer"),t.removeClass("incorrectAnswer")},P=r(14);function S(e){return"".concat(Object(P.a)(),"audio/").concat(e)}var k=r(152),E=r(348),x=r(90),F=r(104);var N=e=>{const t=e.closest(".findInImage"),r=e.closest(".activity"),a=c(t),n=Number(Object(p.a)(t,"gameInstance")||0);e.addClass("selected"),v(t);if(d(a,e)&&u(t,a))return Promise.resolve();const s=Object(k.a)(r)===x.a.capePreview?".mp3":"",o=S("correctAnswer_sfx".concat(s)),i=S("wrongAnswer_sfx".concat(s)),l=b(t,a),m=l?[o]:[i];return t.addClass(l?"correctAnswer":"incorrectAnswer"),function(e,t){return e.addClass("givingFeedback"),A(e,t).then(()=>$(e))}(t,m).then(()=>{const e=Number(Object(p.a)(t,"gameInstance")||0);t.hasClass("playing")&&e==n&&(y.length>0?(I(t),C(t)):(t.removeClass("playing").addClass("gameOver"),Object(E.a)(t,F.b.isGameOverScreen)))})};var T=e=>{e.on("click",".findInImage svg .clickableElement:not(.selected,.correctAnswer,.incorrectAnswer)",e=>{const t=s()(e.currentTarget);N(t)})};var _=e=>{e.removeClass("active"),Object(o.a)(e)};var G=e=>{w(e).each((e,t)=>{_(s()(t))})};let B=0;var R=e=>{e.removeData("previousAttemptedAnswers"),I(e),e.removeClass("gameOver"),e.addClass("playing"),Object(p.c)(e,"gameInstance",++B),G(e),(e=>{const t=w(e),r=j(e),a=O(e);t.removeClass("active"),y=h(t),a&&(y=Object(f.J)(y)),y.length=r})(e),C(e),Object(E.a)(e,F.b.isPlaying)};var q=e=>{Object(a.a)(e,".findInImage",".startGameButton,.replayGameButton",e=>{R(e)}),T(e)};var D=e=>e.find(".findInImage");r(15),r(16);var J=e=>{e.each((e,t)=>{const r=s()(t);(Object(p.a)(r,"data-svgelements")||"").split(" ").forEach(e=>{e.length>0&&r.find("g#".concat(e)).addClass("clickableElement")})})};var U=e=>{w(e).each((e,t)=>{const r=s()(t),a=Object(p.a)(r,"data-answers");Object(f.y)(a)||(Object(m.c)(r,"data-answers",a),Object(p.b)(r,"data-answers"))})},z=r(571),H=r(573),K=r(624);var L=async(e,t)=>{if(e.$activity=t,e.$selector=D(t),Object(z.a)(t))try{await Object(H.a)(t),Object(K.a)(e.$selector)}catch(e){throw console.error(e),new Error(e)}U(e.$selector),J(e.$selector),q(t),Object(E.a)(t,F.b.isStartScreen)},M=r(8);var Q=e=>w(e).map((e,t)=>{const r=s()(t);return{elm:Object(f.v)(r),type:M.a.list,value:Object(o.b)(r)||[]}}).get();var V=e=>{const t=e.data("previousAttemptedAnswers");return t||{elm:Object(f.v)(e)||"",type:M.a.composite,value:Q(e)||[]}};var W=e=>e.map((e,t)=>{const r=s()(t);return V(r)}).get();var X=e=>{let t=!0;return w(e).each((e,r)=>{const a=s()(r);(Object(o.b)(a)||"").length<1&&(t=!1)}),t};var Y=e=>{e.removeClass("givingFeedback"),e.removeClass("correctAnswer"),e.removeClass("incorrectAnswer"),e.removeClass("gameOver"),e.removeClass("playing")};var Z=e=>{e.each((e,t)=>{const r=s()(t);Y(r),G(r),I(r)});const t=Object(f.i)(e);Object(E.a)(t,F.b.isStartScreen)},ee=r(393);var te=e=>{e.removeClass("playing"),e.addClass("gameOver")};r.d(t,"default",(function(){return ne}));const re=["$interaction"];function ae(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class ne{constructor(e){ae(this,"$activity",void 0),ae(this,"$selector",void 0),this.$activity=e}async initialise(){await L(this,this.$activity)}getUserAnswers(){return W(this.$selector)}isComplete(){return X(this.$selector)}showAnswers(e){Object(ee.a)(this.$selector,e,!1,e=>{if((e.value||[]).some(e=>{var t;return(null===(t=e.value)||void 0===t?void 0:t.length)>0})){const t=e.$interaction,{$interaction:r}=e,a=function(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(e,re);t.data("previousAttemptedAnswers",a),te(this.$selector)}})}reset(){Z(this.$selector)}}}}]);
/* build created on 15/08/2025 16:19 */
//# sourceMappingURL=http://localhost:4000/source-maps/interactions/marked/rcfFindInImage.js.map