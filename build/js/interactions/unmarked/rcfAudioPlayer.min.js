(window.rcfRunTime_24113=window.rcfRunTime_24113||[]).push([["interactions/unmarked/rcfAudioPlayer"],{427:function(t,e,r){"use strict";var n=r(19),a=r(42),o=r(23),s=r(20),i=r(41),c=r(24),l=r(75),u=r(61),p=r(49).f,d=r(166),y=o.Symbol,f=y&&y.prototype;if(a&&c(y)&&(!("description"in f)||void 0!==y().description)){var v={},b=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:u(arguments[0]),e=l(f,this)?new y(t):void 0===t?y():y(t);return""===t&&(v[e]=!0),e};d(b,y),b.prototype=f,f.constructor=b;var m="Symbol(test)"==String(y("test")),g=s(f.toString),_=s(f.valueOf),h=/^Symbol\((.*)\)[^)]+$/,w=s("".replace),O=s("".slice);p(f,"description",{configurable:!0,get:function(){var t=_(this),e=g(t);if(i(v,t))return"";var r=m?O(e,7,-1):w(e,h,"$1");return""===r?void 0:r}}),n({global:!0,constructor:!0,forced:!0},{Symbol:b})}},478:function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));r(59),r(100);function n(t){let e=0;if(t){let r=t.split(":");for(let t=0;t<r.length;t++)e=60*e+parseFloat(r[t].replace(",","."))}return e}},633:function(t,e,r){r(634)("asyncIterator")},634:function(t,e,r){var n=r(635),a=r(41),o=r(636),s=r(49).f;t.exports=function(t){var e=n.Symbol||(n.Symbol={});a(e,t)||s(e,t,{value:o.f(t)})}},635:function(t,e,r){var n=r(23);t.exports=n},636:function(t,e,r){var n=r(28);e.f=n},637:function(t,e,r){"use strict";var n=r(19),a=r(46),o=r(92),s=r(21),i=r(50),c=r(24),l=r(164),u=r(260),p=r(54),d=o&&o.prototype;if(n({target:"Promise",proto:!0,real:!0,forced:!!o&&s((function(){d.finally.call({then:function(){}},(function(){}))}))},{finally:function(t){var e=l(this,i("Promise")),r=c(t);return this.then(r?function(r){return u(e,t()).then((function(){return r}))}:t,r?function(r){return u(e,t()).then((function(){throw r}))}:t)}}),!a&&c(o)){var y=i("Promise").prototype.finally;d.finally!==y&&p(d,"finally",y,{unsafe:!0})}},678:function(t,e,r){"use strict";r.r(e);r(25),r(31);var n=r(4),a=(r(427),r(633),r(32),r(33),r(5)),o=r.n(a),s=r(14),i=(r(6),r(11),r(55)),c=r(60),l=r(17);var u=t=>"y"===Object(l.a)(t,"data-opencc");var p=t=>!t.hasClass("noSubtitles");var d=t=>t.hasClass("hasRecordingButton");r(101);var y=t=>{if(navigator.userAgent.includes("ZFBrowser")){const e=document.getElementById(t);return e?e.innerHTML:'<g><rect x="7.25" y="0" width="2.5" height="10.5" stroke-linecap="square" /><circle cx="8.5" cy="16" r="2" /></g>'}return'<use href="#'.concat(t,'"></use>')};var f=t=>{const e=u(t),r=p(t),n=d(t),a={mute:c.a.t("interactions.audioplayer.mute"),pause:c.a.t("interactions.audioplayer.pause"),play:c.a.t("interactions.audioplayer.play"),record:c.a.t("interactions.audioplayer.record"),recordingIndicator:c.a.t("interactions.audioplayer.recordingIndicator"),stop:c.a.t("interactions.audioplayer.stop"),subtitles:c.a.t("interactions.audioplayer.subtitles"),unmute:c.a.t("interactions.audioplayer.unmute"),seek:c.a.t("interactions.audioplayer.seek"),currentTime:c.a.t("interactions.audioplayer.currentTime"),duration:c.a.t("interactions.audioplayer.duration"),volume:c.a.t("interactions.audioplayer.volume"),enableCaptions:c.a.t("interactions.audioplayer.enableCaptions"),disableCaptions:c.a.t("interactions.audioplayer.disableCaptions")};return'\n\t\t<div class="plyr__controls">\n\t\t\t\x3c!-- standard plyr play button --\x3e\n\t\t\t<button class="plyr__controls__item plyr__control" type="button" data-plyr="play" aria-pressed="false" aria-label="">\n\t\t\t\t<svg class="icon--pressed" aria-hidden="true" focusable="false">'.concat(y("plyr-pause"),'</svg>\n\t\t\t\t<svg class="icon--not-pressed" aria-hidden="true" focusable="false">').concat(y("plyr-play"),'</svg>\n\t\t\t\t<span class="label--pressed plyr__sr-only">').concat(a.pause,'</span>\n\t\t\t\t<span class="label--not-pressed plyr__sr-only">').concat(a.play,'</span>\n\t\t\t</button>\n\n\t\t\t\x3c!-- restart / stop button added by plyr with new icon from rcf / wps --\x3e\n\t\t\t<button class="plyr__controls__item plyr__control" type="button" data-plyr="restart" aria-pressed="false" disabled>\n\t\t\t\t<svg aria-hidden="true" focusable="false">').concat(y("plyr-restart"),'</svg>\n\t\t\t\t<span class="plyr__sr-only">Restart</span>\n\t\t\t</button>\n\n\t\t\t\x3c!-- progress container added by plyr --\x3e\n\t\t\t<div class="plyr__controls__item plyr__progress__container">\n\t\t\t\t<div class="plyr__progress">\n\t\t\t\t\t<input data-plyr="seek" type="range" min="0" max="100" step="0.01" value="0" autocomplete="off" role="slider" aria-label="').concat(a.seek,'">\n\t\t\t\t\t<progress class="plyr__progress__buffer" min="0" max="100" value="0" role="progressbar" aria-hidden="true">% buffered</progress>\n\t\t\t\t\t<span role="tooltip" class="plyr__tooltip">00:00</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class="plyr__controls__item plyr__time plyr__time--current" aria-label="').concat(a.currentTime,'">00:00</div>\n\t\t\t<div class="plyr__controls__item plyr__time plyr__time--duration" aria-label="').concat(a.duration,'">00:00</div>\n\n\t\t\t\x3c!-- if there are subtitles then add the button to toggle them --\x3e\n\t\t\t').concat(r?'\n\t\t\t\t<button type="button" class="plyr__controls__item plyr__control '.concat(e?"plyr__control--pressed":"",' audioScriptButton" data-plyr="rcf-captions">\n\t\t\t\t\t<svg class="icon--pressed" role="presentation">').concat(y("plyr-captions-on"),'</svg>\n\t\t\t\t\t<svg class="icon--not-pressed" role="presentation">').concat(y("plyr-captions-off"),'</svg>\n\t\t\t\t\t<span class="label--pressed plyr__sr-only">').concat(a.disableCaptions,'</span>\n\t\t\t\t\t<span class="label--not-pressed plyr__sr-only">').concat(a.enableCaptions,"</span>\n\t\t\t\t</button>\n\t\t\t"):"",'\n\n\t\t\t\x3c!-- volume controls added by plyr --\x3e\n\t\t\t<button type="button" class="plyr__controls__item plyr__control" data-plyr="mute" aria-pressed="false">\n\t\t\t\t<svg class="icon--pressed" role="presentation" aria-hidden="true" focusable="false">').concat(y("plyr-muted"),'</svg>\n\t\t\t\t<svg class="icon--not-pressed" role="presentation" aria-hidden="true" focusable="false">').concat(y("plyr-volume"),'</svg>\n\t\t\t\t<span class="label--pressed plyr__sr-only">').concat(a.unmute,'</span>\n\t\t\t\t<span class="label--not-pressed plyr__sr-only">').concat(a.mute,'</span>\n\t\t\t</button>\n\t\t\t<div class="plyr__controls__item plyr__volume">\n\t\t\t\t<input data-plyr="volume" type="range" min="0" max="1" step="0.05" value="1" autocomplete="off" role="slider" aria-label="').concat(a.volume,'" aria-valuemin="0" aria-valuemax="100" aria-valuenow="100" id="plyr-volume-2690" aria-valuetext="100.0%" style="--value: 100%;">\n\t\t\t</div>\n\n\t\t\t').concat(n?'\n\t\t\t\x3c!-- audio recording controls --\x3e\n\t\t\t<button type="button" class="plyr__controls__item plyr__control" data-plyr="record" aria-label="'.concat(a.record,'" aria-pressed="false">').concat(a.recordingIndicator,"</button>\n\t\t\t\t\t"):"","\n\n\t\t</div>\n\t")},v=r(72);var b=(t,e)=>{const r=c.a.t("interactions.audioplayer",{returnObjects:!0});return{loadSprite:!0,iconUrl:e,controls:f(t),listeners:{restart(){return Object(v.a)(this),this.stop(),!1}},i18n:r}},m=r(208);var g=t=>{t.on("canplay",()=>{Object(m.a)(t)})};var _=t=>{t.on("ended",()=>{Object(v.a)(t)})};var h=t=>{t.on("loadstart",()=>{Object(v.a)(t)})};var w=t=>"y"===Object(l.a)(t,"data-autoCC");var O=t=>t.closest(".audioContainer");function j(t){return t.find(".audioScript")}var x=t=>{const e=j(t);if(Object(n.y)(e))return!1;const r=e.get(0),a=window.getComputedStyle(r);return"none"!==a.display&&"hidden"!==a.visibility},S=r(177);var T=t=>{t.on("play",()=>{const e=o()(t.elements.container),r=Object(n.i)(e),a=O(e);if(p(a)&&w(a)&&!x(a)){e.find('button[data-plyr="rcf-captions"]').click()}r.trigger("rcf.stop.audio"),Object(S.a)(t),Object(i.e)(t)})},C=r(99);r(13);var E=(t,e)=>t.find(".subTitleLine").filter((t,r)=>parseInt(Object(l.a)(o()(r),"data-time")||0)<e+1).last();var P=t=>"y"===Object(l.a)(t,"data-autoscroll");var I=(t,e)=>{e.on("timeupdate",()=>{const r=parseInt(e.currentTime),n=j(t),a=Object(C.a)(t,"lastLine"),o=E(t,r);if(o.length>0){const e=Object(l.a)(o,"data-time");if(a!==e&&(s=".subTitleLine.playing",t.find(s).removeClass("playing"),Object(C.c)(t,"lastLine",e),o.addClass("playing"),P(t))){const t=function(t,e){return t.scrollTop()+e.position().top-t.height()/2+e.height()/2}(n,o);n.animate({scrollTop:t},200)}}var s})};var L=(t,e)=>{const r=p(t);h(e),T(e),g(e),_(e),r&&I(t,e)};function k(t){return t.find(".audioScript.popupPanel")}var $=t=>{const e=k(t).filter(":not(.currentScript)"),r=O(e),n=r.find('button[data-plyr="rcf-captions"]');r.removeClass("scriptOpen"),n.removeClass("plyr__control--pressed"),e.slideUp()};var A=(t,e)=>{const r=Object(n.i)(t),a=k(t);k(r).removeClass("currentScript");!function(t,e,r){const n=k(e),a="rcf.audio.script";e.toggleClass("scriptOpen",r),n.toggleClass("currentScript",r);const o=new CustomEvent(a,{type:a,detail:{status:r?"IS_OPEN":"IS_CLOSED"},bubbles:!0,cancellable:!0,composed:!1});r?n.slideDown(()=>{t.trigger(a,{status:"IS_OPEN"}),t.get(0).dispatchEvent(o)}):(t.trigger(a,{status:"IS_CLOSED"}),t.get(0).dispatchEvent(o),n.slideUp())}(r,t,!a.is(":visible")),$(r),Object(n.F)(e)};var F=t=>{t.on("click",'button[data-plyr="rcf-captions"]',e=>{o()(e.currentTarget).toggleClass("plyr__control--pressed"),A(t,e)})};var B=(t,e)=>{const r=Object(l.a)(e,"data-time")||"0",n=parseInt(r);t.currentTime=n,Object(S.a)(t),t.play()};var R=(t,e)=>{t.on("click",".subTitleLine",t=>{const r=o()(t.currentTarget);B(e,r)})};var D=t=>{t.on("click",'button[data-plyr="record"]',e=>{const r=o()(e.currentTarget);r.toggleClass("plyr__control--pressed");const n=r.attr("aria-pressed");r.attr("aria-pressed","false"===n?"true":"false");t.find(".audioInterface").toggleClass("showRecordingPanel")})};var N=(t,e)=>{t.on("keydown",".subTitleLine",t=>{const r=o()(t.currentTarget);if([13,32].includes(t.which))B(e,r);else if([37,38].includes(t.which)){const t=r.prev();t.length>0&&(B(e,t),t.focus())}else if([39,40].includes(t.which)){const t=r.next();t.length>0&&(B(e,t),t.focus())}[13,32,38,40].includes(t.which)&&t.preventDefault()})};var U=(t,e)=>{F(t),R(t,e),N(t,e),D(t)},q=(r(15),r(16),r(102),r(478));var M=r(550),H=r(551);r(59),r(100);function G(t,e){const r=function(t){let e=t;return e=e.replace(/\r\n|\r|\n/g,"\n"),e=e.trim(),e}(e).split("\n\n");let a=t.find(".audioScript .script");r.forEach(t=>{let e=t.split("\n");if(e.length>=2){const t=function(t,e){return o()("<p class='subTitleLine' data-time='"+t+"' tabindex='0'><span>"+e+"</span>")}(function(t){let e=t.split(" --\x3e ")[0].trim();return parseInt(Object(q.a)(e))}(e[1]),function(t){let e=t[2];if(t.length>2)for(let r=3;r<t.length;r++)e+="\n"+t[r];return Object(n.y)(e)&&(e=""),e=Object(M.a)(e),e=Object(H.a)(e),e}(e));a.append(t)}}),t.removeClass("noSubtitles")}var Q=t=>{t.addClass("noSubtitles");const e=t.find(".audioScriptButton");e.hide(),e.remove()},X=r(152);var Z=t=>new Promise((e,r)=>{const n=new XMLHttpRequest;n.addEventListener("load",()=>{n.status>=200&&n.status<300||0===n.status?e(n.responseText):r(new Error("Failed to load resource ".concat(n.status," ").concat(n.statusText)))}),n.addEventListener("error",()=>{r(new Error("Network error: ".concat(n.status)))}),n.open("GET",t,!0),n.responseType="text",n.send()});var z=async t=>{const e=await fetch(t);if(!e.ok)throw console.error((new Date).toUTCString(),"Failed to load text resource from url ".concat(t),"response status: ".concat(e.status),"response statusText: ".concat(e.statusText)),new Error("Failed to fetch resource [".concat(t,"] - ").concat(e.status," ").concat(e.statusText));return await e.text()},J=r(90);var K=async(t,e)=>t===J.a.navio?await Z(e):await z(e);var V=async(t,e)=>{const r=Object(n.i)(t),a=Object(X.a)(r);try{const r=await K(a,e);r&&r.length>0&&G(t,r)}catch(e){console.error(e),Q(t)}};var W=t=>{const e=Object(n.i)(t);return function(t,e,r){const a=t.find(".audioPlayer"),o=Object(l.a)(a,"data-lookforid")||"";if(r===J.a.capePreview)return o;if(Object(n.y)(e))return"";let s=e;return Object(n.g)(s,"/")||(s+="/"),s+="srt/"+o+".srt",s}(t,Object(n.p)(t),Object(X.a)(e))};var Y=r(181);r(637);var tt=async(t,e)=>await K(t,e);let et;var rt=(t,e)=>null!==document.getElementById("plyr-sprite")?Promise.resolve():et||(et=tt(t,e).then(t=>{if(document.getElementById("plyr-sprite"))return;const e=document.createElement("div");e.setAttribute("id","plyr-sprite"),e.setAttribute("hidden",""),e.setAttribute("aria-hidden","true"),e.setAttribute("focusable","false"),e.innerHTML=t,document.body.insertAdjacentElement("afterbegin",e)}).catch(t=>{throw console.error("Failed to load plyr-sprite: ",t),new Error("Failed to load plyr-sprite: ".concat(t.message))}).finally(()=>{et=void 0}),et);var nt=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.elements.buttons.play[0].disabled=e};var at=(t,e)=>{const r=()=>{if(!e||!e[0])return;const t=e[0].querySelectorAll('.plyr__control[data-plyr="play"]');t&&t.length&&t.forEach(t=>{t.removeAttribute("aria-label")})};r();const n=new MutationObserver(t=>{t.forEach(t=>{("childList"===t.type||"attributes"===t.type&&"aria-label"===t.attributeName)&&r()})});return n.observe(e[0],{attributes:!0,childList:!0,subtree:!0,attributeFilter:["aria-label"]}),n};var ot=(t,e)=>{const r=c.a.language;t.on("ready",()=>{e.find(".plyr__controls").attr("lang",r)})};var st=async(t,e,r)=>{const a=Object(X.a)(e),o=t.attr("data-audiosrc")||"",s=t.find("audio.audioPlayer"),c=p(t);await rt(a,r);const l=b(t,r),u=Object(i.a)(s,l);nt(u,!0),L(t,u),U(t,u),c&&await(async t=>{const e=W(t);Object(n.y)(e)||await V(t,e)})(t);const d=Object(Y.a)(e,{audioQueue:[o],audioCallback:null},!0);return d.sources&&(u.source=d),at(u,t),ot(u,t),new Promise(t=>{u.once("ready",()=>{const e=u.media.querySelector("source");if(e){const t=e.getAttribute("src");t&&t.length>0&&nt(u,!1)}t()})})};function it(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return(it=function(t){this.s=t,this.n=t.next}).prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var r=this.s.return;return void 0===r?Promise.resolve({value:t,done:!0}):e(r.apply(this.s,arguments))},throw:function(t){var r=this.s.return;return void 0===r?Promise.reject(t):e(r.apply(this.s,arguments))}},new it(t)}var ct=async t=>{const{$activity:e}=t,r=Object(s.a)(),n="".concat(r,"images/plyr/plyr.svg"),a=t.$selector.get();var i,c=!1,l=!1;try{for(var u,p=function(t){var e,r,n,a=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);a--;){if(r&&null!=(e=t[r]))return e.call(t);if(n&&null!=(e=t[n]))return new it(e.call(t));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}(a);c=!(u=await p.next()).done;c=!1){const t=u.value;{const r=o()(t);await st(r,e,n)}}}catch(t){l=!0,i=t}finally{try{c&&null!=p.return&&await p.return()}finally{if(l)throw i}}};var lt=async t=>{if(Object(n.y)(t.$selector))throw"Empty $selector in audioPlayer initialise";t.$activity=Object(n.i)(t.$selector),await ct(t)};var ut=t=>{Object(i.k)(t)};var pt=t=>{Object(i.j)(),Object(i.c)(t)};function dt(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r.d(e,"default",(function(){return yt}));class yt{constructor(t){dt(this,"$activity",void 0),dt(this,"$selector",void 0),dt(this,"assetURL",void 0),this.$selector=t,this.$activity=Object(n.i)(t)}async initialise(){await lt(this)}reset(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]||this.stopAll()}stopAll(){ut(this.$activity)}close(){pt(this.$activity)}}}}]);
/* build created on 15/08/2025 16:19 */
//# sourceMappingURL=http://localhost:4000/source-maps/interactions/unmarked/rcfAudioPlayer.js.map